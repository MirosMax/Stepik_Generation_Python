'''
Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ° ğŸŒ¶ï¸
Ğ’Ğ°Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ñ„Ğ°Ğ¹Ğ» exam_results.csv, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ñ€Ğ¾ÑˆĞµĞ´ÑˆĞµĞ¼ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğµ Ğ² Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ ÑƒÑ‡ĞµĞ±Ğ½Ğ¾Ğ¼ Ğ·Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸. Ğ’ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ ÑÑ‚Ğ¾Ğ»Ğ±Ñ†Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ¾ Ğ¸Ğ¼Ñ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ°, Ğ²Ğ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ â€” Ñ„Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ, Ğ² Ñ‚Ñ€ĞµÑ‚ÑŒĞµĞ¼ â€” Ğ¾Ñ†ĞµĞ½ĞºĞ° Ğ·Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½, Ğ² Ñ‡ĞµÑ‚Ğ²ĞµÑ€Ñ‚Ğ¾Ğ¼ â€” Ğ´Ğ°Ñ‚Ğ° Ğ¸ Ğ²Ñ€ĞµĞ¼Ñ ÑĞ´Ğ°Ñ‡Ğ¸ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ YYYY-MM-DD HH:MM:SS, Ğ² Ğ¿ÑÑ‚Ğ¾Ğ¼ â€” Ğ°Ğ´Ñ€ĞµÑ ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‡Ñ‚Ñ‹:

name,surname,score,date_and_time,email
Jayson,Edwards,2,2021-11-10 10:00:00,sonnen@yahoo.com
April,Sims,3,2021-11-01 11:00:00,retoh@outlook.com
...
ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¾ Ğ¿ĞµÑ€ĞµÑĞ´Ğ°Ñ‚ÑŒ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½ Ğ´Ğ²Ğ° Ñ€Ğ°Ğ·Ğ°, Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ¼Ñƒ Ğ¾Ğ½ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²ÑÑ‚Ñ€ĞµÑ‡Ğ°Ñ‚ÑŒÑÑ Ğ² Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ñ„Ğ°Ğ¹Ğ»Ğµ Ğ´Ğ¾ Ñ‚Ñ€Ñ‘Ñ… Ñ€Ğ°Ğ· Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¾Ğ¹ Ğ¸ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ñ‚Ğ¾Ğ¹ Ğ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼ ÑĞ´Ğ°Ñ‡Ğ¸.

ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñƒ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ° Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ ĞµĞ³Ğ¾ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½ÑƒÑ Ğ¾Ñ†ĞµĞ½ĞºÑƒ, Ğ° Ñ‚Ğ°ĞºĞ¶Ğµ Ğ´Ğ°Ñ‚Ñƒ Ğ¸ Ğ²Ñ€ĞµĞ¼Ñ ĞµĞµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ. ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº ÑĞ»Ğ¾Ğ²Ğ°Ñ€ĞµĞ¹, ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¸Ğ· ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ¿Ğ°Ñ€Ñ‹ ĞºĞ»ÑÑ‡-Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:

name â€” Ğ¸Ğ¼Ñ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ°
surname â€” Ñ„Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ°
best_score â€” Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° Ğ·Ğ° ÑĞºĞ·Ğ°Ğ¼ĞµĞ½
date_and_time â€” Ğ´Ğ°Ñ‚Ğ° Ğ¸ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ Ğ² Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ
email â€” Ğ°Ğ´Ñ€ĞµÑ ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ğ¾Ğ¹ Ğ¿Ğ¾Ñ‡Ñ‚Ñ‹
ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ² Ñ„Ğ°Ğ¹Ğ» best_scores.json, Ğ¿Ñ€Ğ¸Ñ‡ĞµĞ¼ ÑĞ»Ğ¾Ğ²Ğ°Ñ€Ğ¸ Ğ² ÑĞ¿Ğ¸ÑĞºĞµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ñ€Ğ°ÑĞ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ñ‹ Ğ² Ğ»ĞµĞºÑĞ¸ĞºĞ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¼ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğ¹ ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ñ‡Ñ‚. ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº ĞºĞ»ÑÑ‡ĞµĞ¹ Ğ² ÑĞ»Ğ¾Ğ²Ğ°Ñ€ÑÑ… Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ¾Ğ¼ Ğ½Ğµ Ğ²Ğ°Ğ¶ĞµĞ½.

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ 1. Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµÑĞ´Ğ°Ñ‡Ğµ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ» Ñ‚Ğ°ĞºÑƒÑ Ğ¶Ğµ Ğ¾Ñ†ĞµĞ½ĞºÑƒ, Ñ‡Ñ‚Ğ¾ Ğ¸ Ğ² Ğ¿Ñ€Ğ¾ÑˆĞ»Ñ‹Ğ¹ Ñ€Ğ°Ğ·, Ñ‚Ğ¾ Ğ² ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğµ Ğ´Ğ°Ñ‚Ñ‹ ÑĞ»ĞµĞ´ÑƒĞµÑ‚ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ´Ğ°Ñ‚Ñƒ Ğ¿ĞµÑ€ĞµÑĞ´Ğ°Ñ‡Ğ¸.

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ 2. Ğ’ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ñ‚ĞµĞ»Ñ Ğ² Ñ„Ğ°Ğ¹Ğ»Ğµ exam_results.csv Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ°Ğ¿ÑÑ‚Ğ°Ñ, Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ¾Ğ¼ ĞºĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸ Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ.

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ 3. ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ñ‡Ğ°ÑÑ‚ÑŒ Ñ„Ğ°Ğ¹Ğ»Ğ° best_scores.json Ğ²Ñ‹Ğ³Ğ»ÑĞ´Ğ¸Ñ‚ Ñ‚Ğ°Ğº:

[
   {
      "name": "Stephen",
      "surname": "Farley",
      "best_score": 3,
      "date_and_time": "2021-11-12 12:00:00",
      "email": "aardo@mac.com"
   },
   {
      "name": "Kaylen",
      "surname": "Horne",
      "best_score": 4,
      "date_and_time": "2021-11-09 11:00:00",
      "email": "aaribaud@att.net"
   },
   ...
]
ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ 4. Ğ£ĞºĞ°Ğ·Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ. ĞÑ‚Ğ²ĞµÑ‚ Ğ½Ğ° Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ.
https://stepik.org/media/attachments/lesson/623073/exam_results.csv
https://stepik.org/media/attachments/lesson/623073/clue_exam_results.txt

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ 5. ĞŸÑ€Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑĞ²Ğ½Ğ¾Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸ UTF-8.
'''

import csv
import json
from datetime import datetime

with open('exam_results.csv', 'r', encoding='utf8') as file:
    data = sorted(
        csv.DictReader(file),
        key=lambda x: datetime.fromisoformat(x['date_and_time'])
    )
    result = {}
    for student in data:
        if student['email'] in result:
            score = int(student['score'])
            if score >= result[student['email']]['best_score']:
                result[student['email']]['best_score'] = score
                result[student['email']]['date_and_time'] = student['date_and_time']
        else:
            result[student['email']] = {
                'name': student['name'],
                'surname': student['surname'],
                'best_score': int(student['score']),
                'date_and_time': student['date_and_time'],
                'email': student['email']
            }

with open('best_scores.json', 'w', encoding='utf8', newline='') as file:
    json.dump(
        sorted(result.values(), key=lambda x: x['email']),
        file,
        indent=3
    )
